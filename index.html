<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PDUFA 2026 Run-Up Watchlist</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050816;
      --bg-card: #0f172a;
      --bg-card-soft: #111827;
      --border-subtle: #1f2937;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.15);
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --text-muted: #6b7280;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.7);
      --radius-xl: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      color: var(--text-main);
      background:
        radial-gradient(circle at top, rgba(34, 197, 94, 0.17), transparent 55%),
        radial-gradient(circle at bottom, rgba(56, 189, 248, 0.1), transparent 55%),
        var(--bg);
      display: flex;
      justify-content: center;
      padding: 24px 12px;
    }

    .app-shell {
      width: 100%;
      max-width: 1240px;
      background: linear-gradient(135deg, #020617 0%, #020617 40%, #020617 100%);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.18);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 22px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      backdrop-filter: blur(18px);
    }

    /* Header */
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 6px 10px 4px;
    }

    .brand { display: flex; align-items: center; gap: 10px; }

    .brand-logo {
      width: 32px; height: 32px; border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #4ade80, #22c55e);
      display: flex; align-items: center; justify-content: center;
      color: #022c22; font-weight: 800; font-size: 16px;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2);
    }

    .brand-text { display: flex; flex-direction: column; gap: 2px; }

    .brand-title {
      font-size: 14px; font-weight: 600; letter-spacing: 0.02em;
      display: flex; align-items: center; gap: 6px;
    }

    .brand-tagline { font-size: 11px; color: var(--text-soft); }

    .pill {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      background-color: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 2px 8px;
      border-radius: 999px;
      color: var(--text-soft);
      white-space: nowrap;
    }

    .top-right {
      display: flex; align-items: center; gap: 8px;
      font-size: 11px; color: var(--text-muted);
      white-space: nowrap;
    }

    .status-dot {
      width: 8px; height: 8px; border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #4ade80, #22c55e);
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);
    }

    .status-label { font-size: 11px; color: var(--text-soft); }

    /* Intro */
    .intro-panel {
      background:
        radial-gradient(circle at top left, rgba(34,197,94,0.12), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56,189,248,0.14), transparent 50%),
        var(--bg-card);
      border-radius: var(--radius-xl);
      padding: 14px 16px 14px;
      border: 1px solid var(--border-subtle);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .intro-main {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    .intro-copy { max-width: 680px; }

    .intro-title {
      font-size: 18px;
      font-weight: 650;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .intro-highlight {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(34, 197, 94, 0.12);
      color: #bbf7d0;
      border: 1px solid rgba(34, 197, 94, 0.6);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      white-space: nowrap;
    }

    .intro-subtitle {
      margin-top: 4px;
      font-size: 12px;
      color: var(--text-soft);
      line-height: 1.5;
    }

    .controls-row {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .primary-button {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(34, 197, 94, 0.7);
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #022c22;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 8px 22px rgba(34, 197, 94, 0.32);
      user-select: none;
    }

    .primary-button span { font-size: 14px; }

    .secondary-text { font-size: 11px; color: var(--text-soft); }

    /* Layout */
    .app-main {
      display: grid;
      grid-template-columns: minmax(0, 1.55fr) minmax(0, 1.1fr);
      gap: 14px;
      align-items: start;
    }

    @media (max-width: 1020px) {
      .app-main { grid-template-columns: minmax(0, 1fr); }
      .top-right { display: none; }
    }

    .card {
      background: var(--bg-card-soft);
      border-radius: var(--radius-xl);
      padding: 10px 12px 10px;
      border: 1px solid var(--border-subtle);
      box-shadow: 0 10px 28px rgba(15, 23, 42, 0.45);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 13px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-title-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--accent-soft);
      border: 1px solid var(--accent);
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.28);
      flex: 0 0 auto;
    }

    .card-subtitle {
      font-size: 11px;
      color: var(--text-soft);
      line-height: 1.4;
      margin-top: 2px;
    }

    /* Filters */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
      align-items: center;
      font-size: 11px;
    }

    .controls label { display: flex; align-items: center; gap: 6px; }

    input[type="text"], select {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #4b5563;
      background: #020617;
      color: var(--text-main);
      font-size: 11px;
      min-width: 155px;
      outline: none;
    }

    input[type="text"]::placeholder { color: #6b7280; }

    /* Watchlist cards */
    .table-list { display: flex; flex-direction: column; gap: 10px; }

    .row-card {
      background: linear-gradient(180deg, rgba(2,6,23,0.9), rgba(2,6,23,0.75));
      border: 1px solid rgba(31, 41, 55, 0.9);
      border-radius: 14px;
      padding: 10px 10px;
      transition: transform 0.08s ease, border-color 0.08s ease;
      cursor: pointer;
    }

    .row-card:hover {
      transform: translateY(-1px);
      border-color: rgba(56,189,248,0.35);
    }

    .row-top {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
      align-items: baseline;
    }

    .row-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 240px;
      flex: 1 1 360px;
    }

    .row-title {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-weight: 650;
      font-size: 12px;
      letter-spacing: 0.01em;
    }

    .row-title .ticker {
      color: #cbd5e1;
      font-weight: 800;
      letter-spacing: 0.08em;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.75);
    }

    .row-sub {
      color: var(--text-soft);
      font-size: 11px;
      line-height: 1.35;
    }

    .row-right {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
      flex: 1 1 280px;
    }

    .kv {
      display: flex;
      flex-direction: column;
      gap: 2px;
      padding: 6px 10px;
      border-radius: 12px;
      border: 1px solid rgba(55,65,81,0.8);
      background: rgba(2, 6, 23, 0.6);
      min-width: 140px;
    }

    .kv .k { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.12em; }
    .kv .v { font-size: 11px; color: #e5e7eb; font-weight: 700; }

    .tag {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      font-weight: 800;
      line-height: 1;
      white-space: nowrap;
    }

    .tag-orphan {
      background: rgba(56, 189, 248, 0.12);
      color: #7dd3fc;
      border: 1px solid rgba(56, 189, 248, 0.5);
    }

    .tag-high {
      background: rgba(34, 197, 94, 0.15);
      color: #bbf7d0;
      border: 1px solid rgba(34, 197, 94, 0.8);
    }

    .tag-medium {
      background: rgba(250, 204, 21, 0.14);
      color: #fde68a;
      border: 1px solid rgba(250, 204, 21, 0.8);
    }

    .tag-low {
      background: rgba(248, 113, 113, 0.16);
      color: #fecaca;
      border: 1px solid rgba(248, 113, 113, 0.9);
    }

    .tag-cluster-4 {
      background: rgba(250, 204, 21, 0.14);
      color: #fde68a;
      border: 1px solid rgba(250, 204, 21, 0.8);
    }

    .tag-cluster-3 {
      background: rgba(56, 189, 248, 0.12);
      color: #7dd3fc;
      border: 1px solid rgba(56, 189, 248, 0.5);
    }

    .tag-untradeable {
      background: rgba(248, 113, 113, 0.16);
      color: #fecaca;
      border: 1px solid rgba(248, 113, 113, 0.9);
    }

    .row-bottom {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .rationale {
      flex: 1 1 520px;
      font-size: 11px;
      color: #cbd5e1;
      line-height: 1.35;
      opacity: 0.95;
    }

    .links {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .link-btn {
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.6);
      color: #e5e7eb;
      text-decoration: none;
      transition: transform 0.08s ease, border-color 0.08s ease;
      user-select: none;
    }

    .link-btn:hover {
      transform: translateY(-1px);
      border-color: rgba(34,197,94,0.45);
    }

    .empty-state {
      padding: 14px 12px;
      border-radius: 14px;
      border: 1px dashed rgba(148,163,184,0.35);
      color: var(--text-soft);
      font-size: 11px;
      background: rgba(2,6,23,0.4);
    }

    /* Charts */
    .chart-grid { display: flex; flex-direction: column; gap: 10px; }

    .chart-card {
      background: radial-gradient(circle at top left, rgba(34,197,94,0.18), transparent 60%),
        #020617;
      border-radius: 12px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 8px 8px 8px;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      margin-bottom: 6px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .chart-header h3 {
      margin: 0;
      font-size: 11px;
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .pill-small {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 1px 6px;
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-soft);
      white-space: nowrap;
    }

    .chart-note { font-size: 10px; color: var(--text-muted); }

    .chart-canvas { height: 260px; width: 100%; }

    /* EXIT SIGNAL (replaces buy/hold/period UI) */
    .exit-panel {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      margin: 8px 0;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.22);
      background: linear-gradient(135deg, rgba(251, 146, 60, 0.10), rgba(248, 113, 113, 0.06));
    }

    .exit-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 240px;
    }

    .exit-title {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 11px;
      font-weight: 900;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #fde68a;
    }

    .exit-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #fb923c;
      box-shadow: 0 0 0 3px rgba(251, 146, 60, 0.25);
    }

    .exit-row {
      display: flex;
      gap: 8px;
      align-items: baseline;
      flex-wrap: wrap;
    }

    .exit-date {
      font-size: 16px;
      font-weight: 900;
      color: #fed7aa;
      font-variant-numeric: tabular-nums;
    }

    .exit-meta {
      font-size: 11px;
      color: var(--text-soft);
    }

    .exit-right {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .countdown-chip {
      display: flex;
      gap: 8px;
      align-items: baseline;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(251, 146, 60, 0.35);
      background: rgba(2, 6, 23, 0.55);
    }

    .count-num {
      font-size: 20px;
      font-weight: 900;
      color: #fb923c;
      line-height: 1;
      font-variant-numeric: tabular-nums;
    }

    .count-label {
      font-size: 10px;
      color: var(--text-soft);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-weight: 800;
    }

    .signal-pill {
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 10px;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(2, 6, 23, 0.55);
      color: #e5e7eb;
      white-space: nowrap;
    }

    .signal-early { border-color: rgba(148, 163, 184, 0.35); color: #cbd5e1; }
    .signal-watch { border-color: rgba(56,189,248,0.35); color: #93c5fd; }
    .signal-active { border-color: rgba(251,146,60,0.55); color: #fdba74; }
    .signal-late { border-color: rgba(248,113,113,0.55); color: #fecaca; }

    .exit-reason {
      margin-top: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(55,65,81,0.65);
      background: rgba(2,6,23,0.5);
      font-size: 11px;
      color: #cbd5e1;
      line-height: 1.45;
    }

    .exit-reason strong { color: #e5e7eb; }

    /* Exit timeline */
    .exit-timeline {
      margin-top: 10px;
      position: relative;
      height: 54px;
      border-radius: 12px;
      border: 1px solid rgba(55, 65, 81, 0.6);
      background: linear-gradient(to bottom, #020617, #0f172a);
      overflow: hidden;
    }

    .exit-timeline .band {
      position: absolute;
      top: 0;
      height: 100%;
    }

    .band-runup {
      left: 0;
      width: 78%;
      background: linear-gradient(135deg, rgba(56,189,248,0.12), rgba(34,197,94,0.08));
    }

    .band-risk {
      left: 78%;
      width: 22%;
      background: linear-gradient(135deg, rgba(251,146,60,0.18), rgba(248,113,113,0.10));
      border-left: 1px solid rgba(251,146,60,0.22);
    }

    .exit-marker {
      position: absolute;
      top: 0;
      height: 100%;
      width: 2px;
      background: #fb923c;
      box-shadow: 0 0 0 3px rgba(251,146,60,0.25);
      transform: translateX(-50%);
      z-index: 2;
    }

    .now-marker {
      position: absolute;
      top: 0;
      height: 100%;
      width: 2px;
      background: #fbbf24;
      box-shadow: 0 0 0 3px rgba(251,191,36,0.22);
      transform: translateX(-50%);
      z-index: 3;
    }

    .timeline-label {
      position: absolute;
      bottom: 6px;
      left: 10px;
      font-size: 10px;
      color: var(--text-muted);
      font-weight: 800;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      z-index: 4;
    }

    .timeline-label.right {
      left: auto;
      right: 10px;
    }

    /* Footer */
    .footer {
      margin-top: 4px;
      font-size: 10px;
      color: var(--text-muted);
      text-align: right;
      padding: 0 6px;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="top-bar">
      <div class="brand">
        <div class="brand-logo">P</div>
        <div class="brand-text">
          <div class="brand-title">
            PDUFA Run-Up Desk
            <span class="pill">ZONDA Research Internal Prototype</span>
          </div>
          <div class="brand-tagline">
            Run-up watchlist • score clusters • explicit exit signal (no buy/hold UI).
          </div>
        </div>
      </div>
      <div class="top-right">
        <span class="status-dot"></span>
        <span class="status-label">Live view • 2026 PDUFA events</span>
      </div>
    </header>

    <section class="intro-panel">
      <div class="intro-main">
        <div class="intro-copy">
          <div class="intro-title">
            2026 PDUFA Watchlist
            <span class="intro-highlight">Clusters + Exit Signal</span>
          </div>
          <div class="intro-subtitle">
            Focus: pre-event run-up observation for small/mid-cap and orphan-focused names. Scores reflect expected
            pre-PDUFA “event beta”. We cluster score <strong>3–4</strong> names as higher-risk but investable,
            and we show an explicit <strong>RCKT Exit Signal</strong> (default: <strong>T-10 calendar days</strong>,
            adjusted to the prior weekday).
          </div>
        </div>
      </div>
      <div class="controls-row">
        <button class="primary-button" id="scrollToCases">
          <span>▶</span>
          Jump to case studies
        </button>
        <div class="secondary-text">
          ZONDAS RESEARCH
        </div>
      </div>
    </section>

    <main class="app-main">
      <!-- Watchlist -->
      <section class="card">
        <div class="card-header">
          <div>
            <div class="card-title">
              <span class="card-title-dot"></span>
              PDUFA 2026 watchlist (research cards)
            </div>
            <div class="card-subtitle">
              Each card includes cluster + “why score” reasoning. Click a row to copy a one-line summary.
            </div>
          </div>
        </div>

        <div class="controls">
          <label>
            <span>Search</span>
            <input id="searchBox" type="text" placeholder="Company, ticker, indication..." />
          </label>

          <label>
            <span>Min score</span>
            <select id="scoreFilter">
              <option value="0">Any</option>
              <option value="3">3+</option>
              <option value="4">4+</option>
              <option value="5">5 only</option>
            </select>
          </label>

          <label>
            <span>Orphan</span>
            <select id="orphanFilter">
              <option value="any">Any</option>
              <option value="yes">Only orphan</option>
              <option value="no">Non-orphan</option>
            </select>
          </label>

          <label>
            <span>Cluster</span>
            <select id="clusterFilter">
              <option value="any">Any</option>
              <option value="high-upside">Higher-risk / High-upside (Score 4)</option>
              <option value="speculative">Speculative / Watch (Score 3)</option>
              <option value="untradeable">Untradeable / Indirect</option>
            </select>
          </label>

          <label>
            <span>Sort</span>
            <select id="sortSelect">
              <option value="pdufa_date:asc">Date ↑</option>
              <option value="pdufa_date:desc">Date ↓</option>
              <option value="runup_priority_score_1to5:desc">Score ↓</option>
              <option value="runup_priority_score_1to5:asc">Score ↑</option>
              <option value="company:asc">Company A→Z</option>
              <option value="company:desc">Company Z→A</option>
            </select>
          </label>
        </div>

        <div id="watchlist" class="table-list"></div>
      </section>

      <!-- Case studies -->
      <section class="card" id="caseStudies">
        <div class="card-header">
          <div>
            <div class="card-title">
              <span class="card-title-dot"></span>
              Case studies: Exit Signal view
            </div>
            <div class="card-subtitle">
              We remove the buy/hold UI and show only: days-to-PDUFA, default exit date, countdown-to-exit, and a clear signal state.
            </div>
          </div>
        </div>

        <div class="chart-grid">
          <!-- RCKT -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>
                RCKT – Rocket Pharmaceuticals
                <span class="pill-small">Score 5 • LAD-I gene therapy</span>
              </h3>
              <div class="chart-note">
                PDUFA: <strong>2026-03-28</strong> • Default Exit: <strong id="rckt-exitdate">--</strong>
              </div>
            </div>

            <!-- Exit signal panel -->
            <div class="exit-panel">
              <div class="exit-left">
                <div class="exit-title"><span class="exit-dot"></span> EXIT SIGNAL</div>
                <div class="exit-row">
                  <div class="exit-date" id="rckt-exitdate-big">--</div>
                  <div class="exit-meta" id="rckt-exitmeta">T-10 calendar days (weekend-adjusted)</div>
                </div>
              </div>

              <div class="exit-right">
                <div class="countdown-chip">
                  <div class="count-num" id="rckt-days-to-exit">--</div>
                  <div class="count-label">days to exit</div>
                </div>
                <div class="countdown-chip" style="border-color: rgba(34,197,94,0.25);">
                  <div class="count-num" id="rckt-days-to-pdufa" style="color:#22c55e;">--</div>
                  <div class="count-label">days to PDUFA</div>
                </div>
                <div class="signal-pill signal-early" id="rckt-exit-signal">Calculating…</div>
              </div>
            </div>

            <!-- Reasoning (more than just calculation) -->
            <div class="exit-reason" id="rckt-exit-reason">
              <strong>Why exit before PDUFA?</strong> We treat PDUFA as a binary volatility cliff. Historically, the most “tradable”
              part is the pre-event attention window; the last ~1–2 weeks tends to concentrate rumor flow, positioning, and hedging.
              <strong>T-10</strong> is used as a default to reduce exposure to the final “headline risk” while still capturing most of the run-up.
              This is a policy rule (not outcome prediction).
            </div>

            <!-- Visual: Run-up band vs risk band + markers -->
            <div class="exit-timeline">
              <div class="band band-runup"></div>
              <div class="band band-risk"></div>
              <div class="timeline-label">Run-up window</div>
              <div class="timeline-label right">Binary risk zone</div>
              <div class="exit-marker" id="rckt-exit-marker" style="left: 0%;"></div>
              <div class="now-marker" id="rckt-now-marker" style="left: 0%;"></div>
            </div>

            <div class="tradingview-widget-container" style="margin-top:10px;">
              <div id="tradingview_rckt" class="chart-canvas"></div>
              <div class="chart-note" style="margin-top: 8px;">
                Buy/Sell:
                <a
                  href="https://www.avanza.se/aktier/om-aktien.html/814735/rocket-pharmaceuticals"
                  target="_blank"
                  rel="noopener noreferrer"
                  style="color:#86efac;"
                >
                  Open Rocket (RCKT) in Avanza
                </a>
              </div>
            </div>
          </div>

          <!-- NUVL (kept as chart only, can add exit signal later) -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>
                NUVL – Nuvalent
                <span class="pill-small">Score 5 • ROS1+ NSCLC</span>
              </h3>
              <div class="chart-note">PDUFA: 2026-09-18 • Target: exit around T-10 to T-7</div>
            </div>
            <div class="tradingview-widget-container">
              <div id="tradingview_nuvl" class="chart-canvas"></div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      Built as an internal sandbox for observing pre-PDUFA price behaviour — not investment advice.
    </footer>
  </div>

  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

  <script>
    const csvHeader = [
      "pdufa_date",
      "drug",
      "brand_name",
      "company",
      "ticker",
      "indication",
      "orphan_drug",
      "therapy_type",
      "market_cap_bucket",
      "listing_region",
      "liquidity_flag",
      "runup_priority_score_1to5",
      "suggested_entry_window_days",
      "suggested_exit_window_days",
      "notes"
    ];

    const inlineCSV = `
pdufa_date,drug,brand_name,company,ticker,indication,orphan_drug,therapy_type,market_cap_bucket,listing_region,liquidity_flag,runup_priority_score_1to5,suggested_entry_window_days,suggested_exit_window_days,notes
2026-01-13,sparsentan,FILSPARI,Travere Therapeutics,TVTX,"FSGS (kidney disease)",Yes,"Small-molecule (dual ETAR/AT1R inhibitor)",Small,US,Listed,4,"T-120 to T-60","T-20 to T-10","sNDA for FSGS; already approved for IgAN"
2026-01-13,imiglucerase,Cerezyme,Sanofi,SNY,"Gaucher disease type 3",Yes,"Enzyme replacement therapy",Large,"EU/US",Listed,1,"T-60 to T-30","T-30 to T-15","sBLA in a mega-cap; usually lower event-driven % moves"
2026-01-31,leniolisib,Joenja,Pharming Group,PHARM.AS,"Pediatric APDS (4–11 years)",Yes,"Small-molecule PI3Kδ inhibitor","Small-Mid",EU,Listed,4,"T-120 to T-60","T-20 to T-10","sNDA, priority review; rare immunodeficiency"
2026-01-31,"epinephrine oral film",Anaphylm,Aquestive Therapeutics,AQST,"Anaphylaxis (allergic reactions)",No,"Small-molecule / oral film formulation",Small,US,Listed,4,"T-120 to T-60","T-20 to T-10","NDA for novel oral epinephrine film; retail/derisking interest"
2026-02-08,"clemidsogene lanparvovec",RGX-121,REGENXBIO,RGNX,"Mucopolysaccharidosis II (MPS II)",Yes,"AAV gene therapy","Small-Mid",US,Listed,5,"T-150 to T-90","T-20 to T-7","High-impact CNS gene therapy; classic binary catalyst"
2026-02-25,"decitabine+cedazuridine + venetoclax","Inqovi + Venclexta","Taiho Oncology / Otsuka",OTSKY,"Acute myeloid leukemia",Yes,"Oral chemo + BCL-2 inhibitor combo",Large,JP/US,Listed,2,"T-60 to T-30","T-30 to T-10","sNDA combo in large-cap ecosystem"
2026-02-28,pegvaliase,Palynziq,BioMarin,BMRN,"Phenylketonuria (PKU)",Yes,"Enzyme substitution (PEGylated)","Mid-Large",US,Listed,3,"T-90 to T-45","T-20 to T-10","sBLA/label refinement; BioMarin is moderately volatile"
2026-02-28,navepegritide,"TransCon CNP",Ascendis Pharma,ASND,Achondroplasia (children),Yes,"Long-acting peptide hormone (CNP)",Mid,"US/EU",Listed,4,"T-120 to T-60","T-20 to T-10","Priority-review growth-disorder asset; attractive single-franchise story"
2026-03-20,setmelanotide,Imcivree,"Rhythm Pharmaceuticals",RYTM,"Acquired hypothalamic obesity",Yes,"Peptide agonist (MC4R)","Small-Mid",US,Listed,4,"T-120 to T-60","T-20 to T-10","Label expansion in rare obesity; sentiment-sensitive"
2026-03-24,linerixibat,,GSK,GSK,"Cholestatic pruritus in PBC",Yes,"Small-molecule IBAT inhibitor",Large,"UK/US",Listed,2,"T-60 to T-30","T-30 to T-10","NDA in rare liver disease; large-cap, lower % swing expected"
2026-03-28,"marnetegragene autotemcel",KRESLADI,"Rocket Pharmaceuticals",RCKT,"LAD-I (ultra-rare immunodeficiency)",Yes,"Ex vivo gene therapy","Small-Mid",US,Listed,5,"T-150 to T-90","T-20 to T-7","Ultra-rare gene therapy; high ‘event trader’ focus"
2026-03-29,"Ga-68 edotreotide",LNTH-2501,Lantheus,LNTH,"SSTR+ neuroendocrine tumor PET imaging",No,"Diagnostic radiopharmaceutical",Mid,US,Listed,3,"T-90 to T-45","T-20 to T-10","Imaging agent complementing NET portfolio"
2026-04-05,"tividenofusp alfa",DNL310,"Denali Therapeutics",DNLI,"Hunter syndrome (MPS II)",Yes,"Brain-penetrant enzyme replacement",Mid,US,Listed,5,"T-150 to T-90","T-20 to T-7","Priority-review CNS ERT; high-profile rare-disease catalyst"
2026-04-06,Orca-T,,Orca Bio,,"AML / ALL / MDS (allogeneic transplant)",Yes,"Cell therapy (engineered graft)",Private,US,Unlisted,3,,,"Private company; equity not directly tradeable"
2026-06-18,"nilotinib (505(b)(2))",XS003,"Xspray Pharma",XSPRAY.ST,"Chronic myeloid leukemia (CML)",No,"Small-molecule TKI reformulation",Small,"EU (Sweden)",Listed,4,"T-120 to T-60","T-20 to T-7","TKI reformulation; Swedish small-cap with clear event date"
2026-07-03,"manganese chloride tetrahydrate",Orviglance,"Ascelia Pharma",ACE.ST,"Liver MRI contrast in renal impairment",Yes,"Imaging contrast agent",Small,"EU (Sweden)",Listed,4,"T-120 to T-60","T-20 to T-7","Orphan contrast agent; binary for a small Nordic biotech"
2026-07-11,relacorilant,,Corcept Therapeutics,CORT,"Platinum-resistant ovarian cancer",Yes,"Cortisol receptor modulator",Mid,US,Listed,4,"T-120 to T-60","T-20 to T-7","Oncology indication; strong phase 3 data drove interest"
2026-07-26,"furosemide autoinjector (SCP-111)","FUROSCIX ReadyFlow","MannKind / scPharmaceuticals partnership",MNKD,"Edema in CHF / CKD",No,"Device + small-molecule combo","Small-Mid",US,Listed,3,"T-90 to T-45","T-20 to T-10","sNDA for new autoinjector; device-formulation narrative"
2026-08-28,177Lu-edotreotide,,ITM,,"GEP-NET (radioligand therapy)",Yes,"Therapeutic radioligand",Private,EU,Unlisted,3,,,"Radioligand; company not US-listed (access may be indirect)"
2026-09-18,zidesamtinib,,Nuvalent,NUVL,"ROS1+ non-small cell lung cancer",Yes,"Small-molecule kinase inhibitor",Mid,US,Listed,5,"T-150 to T-90","T-20 to T-7","Targeted oncology with clean single-asset story; strong run-up candidate"
2026-10-10,tabelecleucel,Tab-cel,"Pierre Fabre / Atara license",ATRA,"EBV+ PTLD (post-transplant lymphoma)",Yes,"Allogeneic T-cell therapy",Small,"US/EU","Listed/Partnered",3,"T-120 to T-60","T-20 to T-10","BLA held by private partner; Atara still sentiment-linked"
`;

    let rows = [];

    function parseCSV(text) {
      const lines = text.trim().split(/\r?\n/);
      const dataLines = lines.slice(1);
      return dataLines.map(line => {
        const cells = [];
        let cur = "";
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
          const c = line[i];
          if (c === '"') inQuotes = !inQuotes;
          else if (c === "," && !inQuotes) { cells.push(cur); cur = ""; }
          else cur += c;
        }
        cells.push(cur);
        const obj = {};
        csvHeader.forEach((key, idx) => {
          obj[key] = (cells[idx] || "").trim().replace(/^"|"$/g, "");
        });
        return obj;
      });
    }

    function isTradeable(row) {
      const listed = (row.liquidity_flag || "").toLowerCase();
      const ticker = (row.ticker || "").trim();
      if (!ticker) return false;
      if (listed.includes("unlisted")) return false;
      return true;
    }

    function buildRationale(row) {
      const score = parseInt(row.runup_priority_score_1to5 || "0", 10);
      const orphan = (row.orphan_drug || "").toLowerCase() === "yes";
      const cap = (row.market_cap_bucket || "").toLowerCase();
      const therapy = (row.therapy_type || "").toLowerCase();
      const notes = (row.notes || "").toLowerCase();

      const bullets = [];
      if (orphan) bullets.push("Orphan/rare angle → tends to attract catalyst flow.");
      if (cap.includes("small")) bullets.push("Smaller cap → higher event beta / sharper run-ups.");
      else if (cap.includes("mid")) bullets.push("Mid-cap → catalyst-sensitive but less explosive.");
      else if (cap.includes("large")) bullets.push("Large-cap dampener → PDUFA impact often diluted.");

      if (therapy.includes("gene")) bullets.push("Gene therapy narrative → binary-catalyst attention.");
      if (therapy.includes("diagnostic") || therapy.includes("imaging") || notes.includes("imaging"))
        bullets.push("Diagnostics/imaging → often lower 'binary' volatility than therapeutics.");
      if (notes.includes("label expansion") || notes.includes("label refinement"))
        bullets.push("Label expansion/refinement → less all-or-nothing than first approval.");
      if (notes.includes("partner") || notes.includes("licensed") || notes.includes("listed/partnered"))
        bullets.push("Partner/structure complexity → can dampen a clean run-up trade.");

      if (score === 4) bullets.push("Score 4 = tradable catalyst with strong run-up potential (higher risk).");
      if (score === 3) bullets.push("Score 3 = speculative/watch: investable but run-up less reliable/dampened.");

      return bullets.slice(0, 4).join(" ");
    }

    function assignCluster(row) {
      const score = parseInt(row.runup_priority_score_1to5 || "0", 10);
      const tradeable = isTradeable(row);
      if (!tradeable) return { key: "untradeable", label: "Untradeable / Indirect", tagClass: "tag-untradeable" };
      if (score === 4) return { key: "high-upside", label: "Higher-risk / High-upside (4)", tagClass: "tag-cluster-4" };
      if (score === 3) return { key: "speculative", label: "Speculative / Watch (3)", tagClass: "tag-cluster-3" };
      return { key: "other", label: "Core / Other", tagClass: "" };
    }

    function tradingViewLink(ticker) {
      const t = (ticker || "").trim().toUpperCase();
      if (!t) return "";
      return `https://www.tradingview.com/symbols/${encodeURIComponent(t)}/`;
    }

    function copyRowSummary(row) {
      const score = row.runup_priority_score_1to5 || "";
      const cluster = row.risk_cluster || "";
      const text =
        `${row.pdufa_date} • ${row.company} (${row.ticker || "N/A"}) • ${row.drug} • ${row.indication} • ` +
        `Score ${score} • ${cluster} • Exit ${row.suggested_exit_window_days || "-"} • ` +
        `Why: ${row.score_rationale || ""}`;
      navigator.clipboard?.writeText(text).catch(() => {});
    }

    function sortRows(arr, sortValue) {
      const [key, direction] = sortValue.split(":");
      const dir = direction === "desc" ? -1 : 1;
      return arr.sort((a, b) => {
        let va = a[key] || "";
        let vb = b[key] || "";

        if (key === "runup_priority_score_1to5") {
          va = parseInt(va || "0", 10);
          vb = parseInt(vb || "0", 10);
        }
        if (key === "pdufa_date") {
          va = new Date(va);
          vb = new Date(vb);
        }
        if (typeof va === "string") va = va.toLowerCase();
        if (typeof vb === "string") vb = vb.toLowerCase();

        if (va < vb) return -1 * dir;
        if (va > vb) return 1 * dir;
        return 0;
      });
    }

    /* Exit-date helpers */
    function formatISODate(d) {
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth() + 1).padStart(2, "0");
      const dd = String(d.getDate()).padStart(2, "0");
      return `${yyyy}-${mm}-${dd}`;
    }

    function adjustToPreviousWeekday(dateObj) {
      const d = new Date(dateObj);
      const day = d.getDay();
      if (day === 6) d.setDate(d.getDate() - 1); // Sat -> Fri
      if (day === 0) d.setDate(d.getDate() - 2); // Sun -> Fri
      return d;
    }

    function computeDefaultExitDate(pdufaDateObj, daysBefore = 10) {
      const d = new Date(pdufaDateObj);
      d.setDate(d.getDate() - daysBefore);
      return adjustToPreviousWeekday(d);
    }

    function getExitSignalState(daysToExit, now, exitDate, pdufaDate) {
      // Simple policy states (you can tune these thresholds)
      // >21 days: Early
      // 21..11: Watch
      // 10..0: Exit Active
      // <0 and before PDUFA: Late
      if (now >= pdufaDate) return { cls: "signal-late", text: "PDUFA passed" };
      if (daysToExit > 21) return { cls: "signal-early", text: "Early • Monitor" };
      if (daysToExit > 10) return { cls: "signal-watch", text: "Watch • Tighten plan" };
      if (daysToExit >= 0) return { cls: "signal-active", text: "EXIT ACTIVE • De-risk" };
      return { cls: "signal-late", text: "Late • Risk zone" };
    }

    function updateRCKTExitPanel() {
      // RCKT fixed PDUFA date
      const pdufaDate = new Date("2026-03-28T00:00:00");
      const now = new Date();

      // Policy: default exit = T-10 calendar days (weekend-adjusted to previous weekday)
      const defaultExit = computeDefaultExitDate(pdufaDate, 10);

      const daysToExit = Math.ceil((defaultExit - now) / (1000 * 60 * 60 * 24));
      const daysToPdufa = Math.ceil((pdufaDate - now) / (1000 * 60 * 60 * 24));

      const exitISO = formatISODate(defaultExit);

      // Fill dates
      const exitSmall = document.getElementById("rckt-exitdate");
      const exitBig = document.getElementById("rckt-exitdate-big");
      if (exitSmall) exitSmall.textContent = exitISO;
      if (exitBig) exitBig.textContent = exitISO;

      // Countdown chips
      const dte = document.getElementById("rckt-days-to-exit");
      const dtp = document.getElementById("rckt-days-to-pdufa");
      if (dte) dte.textContent = isFinite(daysToExit) ? daysToExit : "--";
      if (dtp) dtp.textContent = isFinite(daysToPdufa) ? daysToPdufa : "--";

      // Signal pill
      const signal = document.getElementById("rckt-exit-signal");
      const state = getExitSignalState(daysToExit, now, defaultExit, pdufaDate);
      if (signal) {
        signal.className = `signal-pill ${state.cls}`;
        signal.textContent = state.text;
      }

      // Update reasoning text with contextual values
      const reason = document.getElementById("rckt-exit-reason");
      if (reason) {
        reason.innerHTML = `
          <strong>Why exit on ${exitISO} (T-10)?</strong>
          PDUFA is treated as a binary volatility cliff. The final ~1–2 weeks often compress positioning, rumor flow,
          hedging and liquidity shocks. A default <strong>T-10</strong> exit is a policy rule aimed at:
          <ul style="margin:8px 0 0 18px; padding:0; color:#cbd5e1;">
            <li><strong>Capturing most of the run-up</strong> while avoiding the highest headline sensitivity (T-7→event).</li>
            <li><strong>Reducing gap risk</strong> from leaks/PRs/adcom chatter that can hit outside market hours.</li>
            <li><strong>Keeping execution practical</strong>: you still have ~${Math.max(0, daysToPdufa)} days to PDUFA, but only ~${Math.max(0, daysToExit)} days until the default exit.</li>
          </ul>
          <div style="margin-top:8px; color: var(--text-soft);">
            Note: exit date is weekend-adjusted (exit on the prior weekday if T-10 lands on Sat/Sun).
          </div>
        `;
      }

      // Timeline markers (0% = today, 100% = PDUFA)
      const total = (pdufaDate - now);
      const nowPos = 0; // by definition in this view
      const exitMarker = document.getElementById("rckt-exit-marker");
      const nowMarker = document.getElementById("rckt-now-marker");

      // Map: today = 0%, PDUFA = 100%. Exit = (exit - now)/(pdufa - now)
      let exitPos = 0;
      if (total > 0) {
        exitPos = ((defaultExit - now) / total) * 100;
      }
      exitPos = Math.max(0, Math.min(100, exitPos));

      if (exitMarker) exitMarker.style.left = `${exitPos}%`;
      if (nowMarker) nowMarker.style.left = `${nowPos}%`;
    }

    function renderWatchlist() {
      const container = document.getElementById("watchlist");
      const search = document.getElementById("searchBox").value.toLowerCase();
      const minScore = parseInt(document.getElementById("scoreFilter").value, 10);
      const orphanFilter = document.getElementById("orphanFilter").value;
      const clusterFilter = document.getElementById("clusterFilter").value;
      const sortValue = document.getElementById("sortSelect").value;

      let filtered = rows.filter(r => {
        const text = (
          (r.company || "") + " " +
          (r.ticker || "") + " " +
          (r.indication || "") + " " +
          (r.drug || "") + " " +
          (r.notes || "")
        ).toLowerCase();

        if (search && !text.includes(search)) return false;

        const score = parseInt(r.runup_priority_score_1to5 || "0", 10);
        if (!isNaN(minScore) && score < minScore) return false;

        if (orphanFilter === "yes" && (r.orphan_drug || "").toLowerCase() !== "yes") return false;
        if (orphanFilter === "no" && (r.orphan_drug || "").toLowerCase() === "yes") return false;

        if (clusterFilter !== "any" && (r.risk_cluster_key || "") !== clusterFilter) return false;

        return true;
      });

      filtered = sortRows(filtered, sortValue);

      container.innerHTML = "";

      if (!filtered.length) {
        container.innerHTML = `<div class="empty-state">No results. Try widening filters or clearing the search.</div>`;
        return;
      }

      for (const r of filtered) {
        const score = parseInt(r.runup_priority_score_1to5 || "0", 10);
        let scoreTagClass = "tag-low";
        if (score >= 5) scoreTagClass = "tag-high";
        else if (score >= 4) scoreTagClass = "tag-medium";

        const orphanTag = (r.orphan_drug || "").toLowerCase() === "yes"
          ? `<span class="tag tag-orphan">Orphan</span>` : "";

        const clusterTag = r.risk_cluster_tag
          ? `<span class="tag ${r.risk_cluster_tag}">${r.risk_cluster}</span>`
          : `<span class="tag" style="border:1px solid rgba(148,163,184,0.35); background:rgba(15,23,42,0.6); color:#e5e7eb;">${r.risk_cluster}</span>`;

        const tv = tradingViewLink(r.ticker);

        const card = document.createElement("div");
        card.className = "row-card";
        card.title = "Click to copy a one-line summary to clipboard";
        card.addEventListener("click", () => copyRowSummary(r));

        card.innerHTML = `
          <div class="row-top">
            <div class="row-left">
              <div class="row-title">
                <span>${r.company}</span>
                <span class="ticker">${r.ticker || "N/A"}</span>
                <span style="display:flex; gap:6px; flex-wrap:wrap; align-items:center;">
                  ${orphanTag}
                  <span class="tag ${scoreTagClass}">Score ${score || ""}</span>
                  ${clusterTag}
                </span>
              </div>
              <div class="row-sub">
                <strong>${r.drug}</strong>
                ${r.brand_name ? ` • <span style="color:#cbd5e1;">${r.brand_name}</span>` : ""}
                • <span style="color:#e5e7eb;">${r.indication}</span>
              </div>
            </div>

            <div class="row-right">
              <div class="kv">
                <div class="k">PDUFA Date</div>
                <div class="v">${r.pdufa_date}</div>
              </div>
              <div class="kv">
                <div class="k">Entry</div>
                <div class="v">${r.suggested_entry_window_days || "-"}</div>
              </div>
              <div class="kv">
                <div class="k">Exit</div>
                <div class="v">${r.suggested_exit_window_days || "-"}</div>
              </div>
            </div>
          </div>

          <div class="row-bottom">
            <div class="rationale">
              <span style="color:var(--text-muted); font-weight:900;">Why this score:</span>
              ${r.score_rationale || ""}
              ${r.notes ? `<div style="margin-top:6px; color:var(--text-soft);"><span style="color:var(--text-muted); font-weight:900;">Notes:</span> ${r.notes}</div>` : ""}
            </div>

            <div class="links">
              ${tv ? `<a class="link-btn" href="${tv}" target="_blank" rel="noopener noreferrer">TradingView</a>` : ""}
            </div>
          </div>
        `;

        container.appendChild(card);
      }
    }

    function setupFilters() {
      document.getElementById("searchBox").addEventListener("input", renderWatchlist);
      document.getElementById("scoreFilter").addEventListener("change", renderWatchlist);
      document.getElementById("orphanFilter").addEventListener("change", renderWatchlist);
      document.getElementById("clusterFilter").addEventListener("change", renderWatchlist);
      document.getElementById("sortSelect").addEventListener("change", renderWatchlist);
    }

    function initTradingViewWidgets() {
      if (typeof TradingView === "undefined") {
        console.error("TradingView library not loaded");
        return;
      }
      new TradingView.widget({
        container_id: "tradingview_rckt",
        symbol: "NASDAQ:RCKT",
        interval: "D",
        timezone: "Etc/UTC",
        theme: "dark",
        style: "1",
        locale: "en",
        hide_top_toolbar: false,
        hide_legend: false,
        height: 260,
        width: "100%"
      });
      new TradingView.widget({
        container_id: "tradingview_nuvl",
        symbol: "NASDAQ:NUVL",
        interval: "D",
        timezone: "Etc/UTC",
        theme: "dark",
        style: "1",
        locale: "en",
        hide_top_toolbar: false,
        hide_legend: false,
        height: 260,
        width: "100%"
      });
    }

    function init() {
      rows = parseCSV(inlineCSV).map(r => {
        const cluster = assignCluster(r);
        return {
          ...r,
          risk_cluster: cluster.label,
          risk_cluster_key: cluster.key,
          risk_cluster_tag: cluster.tagClass,
          score_rationale: buildRationale(r)
        };
      });

      setupFilters();
      renderWatchlist();

      document.getElementById("scrollToCases").addEventListener("click", () => {
        document.getElementById("caseStudies")?.scrollIntoView({ behavior: "smooth", block: "start" });
      });

      updateRCKTExitPanel();
      setInterval(updateRCKTExitPanel, 1000 * 60 * 60);

      setTimeout(initTradingViewWidgets, 600);
    }

    window.addEventListener("load", init);
  </script>
</body>
</html>

